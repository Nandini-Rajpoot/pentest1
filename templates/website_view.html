{% extends 'base/master.html' %}
{% load static %}

{% block title %}
Website View
{% endblock title %}

{% block css %}

<style>
  /* website_view.css */

  #website-view {
    background-color: #f8f9fa;
    padding: 30px 0;
  }

  #website-view h1 {
    color: #343a40;
  }

  #website-view .lead {
    color: #6c757d;
  }

  #website-view .table {
    margin-top: 20px;
  }

  #website-view .btn {
    display: block;
    width: 50%;
    margin-top: 20px;
  }

  .card {
    animation: fadeIn 2s;
    border-radius: 15px;
    /* Rounded corners */
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    /* Shadow effect */
    transition: 0.3s;
    /* Adds a transition effect when hovering the card */
  }

  .card:hover {
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    /* Shadow effect intensifies on hover */
  }

  .card-body {
    padding: 2em;
    /* More padding inside the card */
  }

  .card-title {
    color: #007BFF;
    /* Title color */
    text-align: center;
    /* Center the title */
  }

  .card-text {
    color: #6c757d;
    /* Text color */
    text-align: justify;
    /* Justify the text */
  }

  .img-fluid {
    max-width: 110%;
    /* Adjust this value as needed */
    height: auto;
  }

  .card-img-top {
    height: 300px;
    width: 500px;

  }

  .p1 {
    height: 375px;


  }
</style>
{% endblock css %}

{% block content %}
<div class="container">
  <div class="add" data-aos="fade-up" data-aos-delay="200">
    <div class="row gx-0">
      <div class="col-lg-6 d-flex align-items-center justify-content-center">
        <div class="card">
          <div class="card-body">
            <header class="section-header">
              <h2 class="card-title mt-5">{{project.name}}</h2>
              <p class="card-text text-center">Cybersec Result</p>
              <h3 class="lead text-center mt-3">
                {{project.url}}
              </h3>
              <a href="{% url 'test_selection' project.id %}" class="btn btn-success">Initiate Tests</a>
              <a href="{% url 'project_delete' project.id %}" class="btn btn-danger">Delete</a>
            </header>
          </div>
        </div>
      </div>
      <div class="col-lg-6 d-flex align-items-center justify-content-center">
        <img src="/static/img/view2.jpg" class="img-fluid" alt="" data-aos="zoom-out" data-aos-delay="200" />
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 mb-3">
        <div class="card">
          <img class="card-img-top" src="/static/img/result.jpg" alt="Title" />
          <div class="card-body">
            <h4 class="card-title">Scan Details</h4>
            {% if scanners %}

            <table class="table">
              <thead>
                <tr>
                  <th scope="col">#ID</th>
                  <th scope="col">Project URL</th>
                  <th scope="col">Start Port</th>
                  <th scope="col">End Port</th>
                  <th scope="col">Open Ports</th>
                  <th scope="col">Test Time</th>

                </tr>
              </thead>
              <tbody>
                {% for scan in scanners %}
                <tr>
                  <td>{{ scan.project }}</td>
                  <td>{{ project.url }}</td>
                  <td>{{ scan.start_port }}</td>
                  <td>{{ scan.end_port }}</td>
                  <td>
                    {% if scan.open_ports %}
                    {{ scan.open_ports }}
                    {% else %}
                    No open ports found
                    {% endif %}
                  </td>

                  <td>{{ scan.start_time }}</td>

                </tr>
                {% endfor %}
              </tbody>
            </table>

            {% else %}
            <p class="card-text">No Scan Result</p>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="col-md-12">
        <div class="card text-start">
          <img class="card-img-top p1" src="/static/img/result1.jpg" alt="Title" />
          <div class="card-body">
            <h4 class="card-title">XSS and CSRF attack</h4>
            {% if xss %}
            <p class="card-text">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">#ID</th>
                  <th scope="col">Project URL</th>
                  <th scope="col">Xss </th>
                  <th scope="col">Vulnerable</th>
                </tr>
              </thead>
              <tbody>
                {% for scan in xss %}
                <tr>
                  <td>{{ scan.project }}</td>
                  <td>{{ project.url }}</td>
                  <td>

                    {% if scan.xss_vulnerabilities|length > 1 %}
                    Vulnerable ⚠️ {{scan.xss_vulnerabilities}}
                    {% else %}
                    Not Vulnerable ✅
                    {% endif %}

                  </td>

                  <td>
                    {% if scan.csrf_vulnerabilities %}
                    Vulnerable ⚠️ {{scan.csrf_vulnerabilities}}
                    {% else %}
                    Not Vulnerable ✅
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <p class="card-text">No Scan Result</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 mb-3">
      <div class="card">
        <img class="card-img-top" src="/static/img/result.jpg" alt="Title" />
        <div class="card-body">
          <h4 class="card-title">Directory Traversal Attack</h4>
          {% if scanners %}
          <p class="card-text">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">#ID</th>
                <th scope="col">Test Result</th>
                <th scope="col">Date</th>
              </tr>
            </thead>
            <tbody>
              {% for scan in dirtravels %}
              <tr>
                <td>{{ scan.id }}</td>
                <td>

                  <table class="table table-hover">
                    {% for k,v in scan.test_results.items %}
                    <tr>
                      <td>{{k}}</td>
                      <td>

                        {% if v != 'Error' %}
                        Insecure ⚠️
                        {% else %}
                        secure ✅
                        {% endif %}

                      </td>
                    </tr>
                    {% endfor %}
                  </table>

                </td>
                <td>{{ scan.created_at.date }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <p class="card-text">No Scan Result</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="card text-start">
        <img class="card-img-top" src="/static/img/result.jpg" alt="Title" />
        <div class="card-body">
          <h4 class="card-title">Session Hijacking Attack</h4>
          {% if scanners %}
          <p class="card-text">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">#ID</th>
                <th scope="col">Url</th>
                <th scope="col">Vulnerable</th>

                <th scope="col">Date</th>
              </tr>
            </thead>
            <tbody>
              {% for scan in hijacks %}
              <tr>
                <td>{{ scan.id }}</td>
                <td>{{ scan.url }}</td>
                <td>
                  {% if scan.is_vulnerable %}
                  {{ scan.is_vulnerable }} ⚠️
                  {% else %}
                  {{ scan.is_vulnerable }} ✅
                  {% endif %}
                </td>

                <td>{{ scan.created_at.date }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <p class="card-text">No Scan Result</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}